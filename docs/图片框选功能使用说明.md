# 图片框选搜索功能使用说明

## 功能概述

在浮图图片检索系统中，我们新增了图片框选功能，允许用户在上传的图片中选择特定区域进行搜索，而不是搜索整张图片。

## 功能特点

### 1. 直观的框选界面
- 在图片上拖拽鼠标即可框选区域
- 实时显示框选区域的可视化边框
- 支持重新框选和重置操作

### 2. 框选区域预览
- 框选完成后会显示框选区域的预览图
- 确认框选的内容是否正确

### 3. 智能搜索模式
- 可以选择搜索整张图片或只搜索框选的区域
- 按钮文字会根据当前模式自动更新

## 使用步骤

### 1. 上传图片
1. 点击上传区域或拖拽图片文件
2. 选择要搜索的图片文件（支持常见图片格式）

### 2. 框选区域（可选）
1. 在显示的图片上按住鼠标左键
2. 拖拽鼠标框选想要搜索的区域
3. 松开鼠标完成框选

### 3. 预览和确认
1. 系统会显示框选区域的实时预览
2. 点击"确认框选"按钮生成框选后的图片
3. 如需重新框选，点击"重置框选"按钮

### 4. 执行搜索
1. 选择要搜索的数据集
2. 点击搜索按钮：
   - 如果有框选区域："搜索框选区域"
   - 如果没有框选："搜索整张图片"

## 技术实现

### 前端实现
- **ImageCropper.vue**: 新的图片框选组件
  - 支持鼠标拖拽框选
  - 实时预览框选区域
  - 生成框选后的图片文件

- **ImageSearch.vue**: 更新的搜索组件
  - 集成框选功能
  - 支持两种搜索模式
  - 智能按钮状态管理

### 后端支持
后端已经支持图片裁剪功能：
- 接收裁剪参数 `(crop_x, crop_y, crop_w, crop_h)`
- 当框选区域有效时，自动裁剪图片进行特征提取
- 返回基于裁剪区域的搜索结果

## 使用建议

### 1. 什么时候使用框选功能
- 图片中有多个不同的物体，只想搜索其中一个
- 背景复杂，想要排除背景干扰
- 关注图片的某个特定细节或局部特征

### 2. 框选技巧
- 尽量框选完整的目标对象
- 避免框选过小的区域（可能影响搜索精度）
- 确保框选区域包含足够的特征信息

### 3. 性能优化
- 框选后的图片会在浏览器中处理，大图片可能需要稍等
- 建议框选区域不要过大（保持合理的分辨率）

## 兼容性说明

- 支持所有现代浏览器（Chrome、Firefox、Safari、Edge）
- 移动端也支持触摸操作进行框选
- 与现有的搜索功能完全兼容

## 故障排除

### 1. 框选不响应
- 确保图片已完全加载
- 检查浏览器是否支持Canvas功能

### 2. 框选区域不正确
- 点击"重置框选"重新操作
- 确保在图片范围内进行框选

### 3. 搜索结果异常
- 确认数据集索引已构建
- 检查框选区域是否包含有效特征

## 更新日志

### v1.1.0 (当前版本)
- ✨ 新增图片框选功能
- ✨ 支持框选区域实时预览
- ✨ 智能搜索模式切换
- 🐛 修复了图片显示的一些问题
- 💄 优化了用户界面交互体验

---

如有问题或建议，请联系开发团队。
